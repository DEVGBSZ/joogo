<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AstroVaders</title>
    <style>
        body {
            background-color: #000;
            color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            font-family: 'Courier New', Courier, monospace;
            text-align: center;
        }
        #gameContainer {
            border: 2px solid #ff00ff; /* Borda rosa */
            position: relative;
            background-color: #1a001a; /* Fundo roxo escuro */
            overflow: hidden;
        }
        canvas {
            background-color: #000;
            display: block;
        }
        #ui {
            position: absolute;
            top: 10px;
            left: 10px;
            color: #ff00ff; /* UI rosa */
            font-size: 24px;
        }
        #startScreen, #gameOverScreen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #ff00ff; /* Texto rosa */
        }
        h1 {
            font-size: 50px;
            margin-bottom: 20px;
            text-shadow: 0 0 10px #ff00ff; /* Sombra rosa */
        }
        p {
            font-size: 20px;
            margin-bottom: 30px;
        }
        button {
            padding: 15px 30px;
            font-size: 20px;
            cursor: pointer;
            background-color: #000;
            color: #ff00ff; /* Botão rosa */
            border: 2px solid #ff00ff; /* Borda botão rosa */
            text-transform: uppercase;
            transition: background-color 0.3s, color 0.3s;
        }
        button:hover {
            background-color: #ff00ff; /* Hover botão rosa */
            color: #000;
        }
    </style>
</head>
<body>

<div id="gameContainer">
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <div id="ui">PONTOS: <span id="score">0</span></div>
    <div id="startScreen">
        <h1>AstroVaders</h1>
        <p>Use as setas para mover e a barra de espaço para atirar.<br>Cuidado: asteroides que passarem por você tirarão pontos!</p>
        <button id="startButton">Iniciar Jogo</button>
    </div>
    <div id="gameOverScreen" style="display: none;">
        <h1>Fim de Jogo</h1>
        <p>Sua pontuação final: <span id="finalScore">0</span></p>
        <button id="restartButton">Jogar Novamente</button>
    </div>
</div>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const scoreEl = document.getElementById('score');
    const startScreen = document.getElementById('startScreen');
    const gameOverScreen = document.getElementById('gameOverScreen');
    const startButton = document.getElementById('startButton');
    const restartButton = document.getElementById('restartButton');
    const finalScoreEl = document.getElementById('finalScore');

    let score = 0;
    let gameRunning = false;
    let animationId;

    // --- Configurações do Jogo ---
    const PLAYER_WIDTH = 50;
    const PLAYER_HEIGHT = 20;
    const PLAYER_SPEED = 7;
    const BULLET_SPEED = 10;
    const BULLET_RADIUS = 3;
    const ASTEROID_SIZES = { large: 40, medium: 25, small: 15 };
    const ASTEROID_SPEED = 1;
    const ASTEROID_SPAWN_INTERVAL = 1200; // ms
    const POINTS_LOST_ON_MISS = 20; // Pontos perdidos quando um asteroide passa

    // --- Entidades do Jogo ---
    class Player {
        constructor() {
            this.width = PLAYER_WIDTH;
            this.height = PLAYER_HEIGHT;
            this.x = canvas.width / 2 - this.width / 2;
            this.y = canvas.height - this.height - 10;
            this.speed = PLAYER_SPEED;
            this.dx = 0;
        }

        draw() {
            ctx.fillStyle = '#ff00ff'; /* Rosa para o jogador */
            ctx.fillRect(this.x, this.y, this.width, this.height);
        }

        update() {
            this.x += this.dx;
            if (this.x < 0) this.x = 0;
            if (this.x + this.width > canvas.width) this.x = canvas.width - this.width;
            this.draw();
        }

        moveRight() { this.dx = this.speed; }
        moveLeft() { this.dx = -this.speed; }
        stop() { this.dx = 0; }
    }

    class Bullet {
        constructor(x, y) {
            this.x = x;
            this.y = y;
            this.radius = BULLET_RADIUS;
            this.speed = BULLET_SPEED;
        }

        draw() {
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
            ctx.fillStyle = '#ff69b4'; /* Rosa choque para as balas */
            ctx.fill();
            ctx.closePath();
        }

        update() {
            this.y -= this.speed;
            this.draw();
        }
    }

    class Asteroid {
        constructor(x, y, size) {
            this.x = x;
            this.y = y;
            this.size = size;
            this.radius = ASTEROID_SIZES[size];
            this.speed = ASTEROID_SPEED + Math.random();
            this.dx = (Math.random() - 0.5) * 2; // Movimento horizontal leve
        }

        draw() {
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
            ctx.strokeStyle = '#dda0dd'; /* Lilás/Roxo claro para os asteroides */
            ctx.stroke();
            ctx.closePath();
        }

        update() {
            this.y += this.speed;
            this.x += this.dx;
            if (this.x + this.radius < 0) this.x = canvas.width + this.radius; // Volta para o outro lado
            if (this.x - this.radius > canvas.width) this.x = -this.radius; // Volta para o outro lado
            this.draw();
        }
    }

    // --- Gerenciamento do Jogo ---
    let player;
    let bullets;
    let asteroids;
    let asteroidSpawner;

    function init() {
        score = 0;
        scoreEl.textContent = 0;
        player = new Player();
        bullets = [];
        asteroids = [];
        gameOverScreen.style.display = 'none';
        startScreen.style.display = 'flex';
    }

    function startGame() {
        gameRunning = true;
        startScreen.style.display = 'none';
        asteroidSpawner = setInterval(spawnAsteroid, ASTEROID_SPAWN_INTERVAL);
        animate();
    }
    
    function endGame() {
        gameRunning = false;
        clearInterval(asteroidSpawner);
        cancelAnimationFrame(animationId);
        finalScoreEl.textContent = score;
        gameOverScreen.style.display = 'flex';
    }

    function spawnAsteroid() {
        const x = Math.random() * canvas.width;
        const y = -ASTEROID_SIZES.large;
        asteroids.push(new Asteroid(x, y, 'large'));
    }

    function updateScore(points) {
        score += points;
        scoreEl.textContent = score;
    }

    function handleCollisions() {
        // Balas vs Asteroides
        for (let i = bullets.length - 1; i >= 0; i--) {
            for (let j = asteroids.length - 1; j >= 0; j--) {
                const bullet = bullets[i];
                const asteroid = asteroids[j];
                const dist = Math.hypot(bullet.x - asteroid.x, bullet.y - asteroid.y);

                if (dist - asteroid.radius - bullet.radius < 1) {
                    // Colisão!
                    if (asteroid.size === 'large') {
                        asteroids.push(new Asteroid(asteroid.x, asteroid.y, 'medium'));
                        asteroids.push(new Asteroid(asteroid.x, asteroid.y, 'medium'));
                        updateScore(10);
                    } else if (asteroid.size === 'medium') {
                        asteroids.push(new Asteroid(asteroid.x, asteroid.y, 'small'));
                        asteroids.push(new Asteroid(asteroid.x, asteroid.y, 'small'));
                        updateScore(20);
                    } else {
                        updateScore(50);
                    }
                    
                    asteroids.splice(j, 1);
                    bullets.splice(i, 1);
                    break; // Sai do loop interno para evitar erro com array modificado
                }
            }
        }

        // Asteroides vs Jogador e Asteroides passando pela tela
        for (let i = asteroids.length - 1; i >= 0; i--) {
            const asteroid = asteroids[i];
            
            // Colisão com o jogador
            if (
                asteroid.x - asteroid.radius < player.x + player.width &&
                asteroid.x + asteroid.radius > player.x &&
                asteroid.y - asteroid.radius < player.y + player.height &&
                asteroid.y + asteroid.radius > player.y
            ) {
                endGame();
            }

            // Asteroide saiu da tela por baixo (perde pontos)
            if (asteroid.y - asteroid.radius > canvas.height) {
                updateScore(-POINTS_LOST_ON_MISS); // Perde pontos
                asteroids.splice(i, 1); // Remove o asteroide
            }
        }
    }

    // --- Loop Principal do Jogo ---
    function animate() {
        if (!gameRunning) return;
        animationId = requestAnimationFrame(animate);
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        player.update();
        
        bullets.forEach((bullet, index) => {
            bullet.update();
            if (bullet.y < 0) {
                bullets.splice(index, 1);
            }
        });

        asteroids.forEach((asteroid, index) => {
            asteroid.update();
        });

        handleCollisions();
    }

    // --- Controles ---
    const keys = {
        ArrowRight: false,
        ArrowLeft: false
    };

    function updatePlayerMovement() {
        if (keys.ArrowRight) {
            player.moveRight();
        } else if (keys.ArrowLeft) {
            player.moveLeft();
        } else {
            player.stop();
        }
    }
    
    window.addEventListener('keydown', (e) => {
        if (!gameRunning) return;
        if (e.key === 'ArrowRight' || e.key === 'ArrowLeft') {
            keys[e.key] = true;
            updatePlayerMovement();
        }
        if (e.key === ' ') {
            e.preventDefault(); // Impede que a página role
            bullets.push(new Bullet(player.x + player.width / 2, player.y));
        }
    });

    window.addEventListener('keyup', (e) => {
        if (e.key === 'ArrowRight' || e.key === 'ArrowLeft') {
            keys[e.key] = false;
            updatePlayerMovement();
        }
    });
    
    // --- Botões da UI ---
    startButton.addEventListener('click', () => {
        init();
        startGame();
    });

    restartButton.addEventListener('click', () => {
        init();
        startGame();
    });

    // Inicia o estado inicial do jogo
    init();

</script>
</body>
</html>